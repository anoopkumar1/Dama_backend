<style>
    .card-header {
        background-color: #0056b3;
    }

    .card-header h3 {
        color: #fff;
    }

    .card-description {
        font-weight: 500 !important;
        margin-left: 0px !important;
        font-size: 17px !important;
        margin-bottom: 0.875rem !important;
    }

    .card-body {
        background: #fff;
    }

    .submit-data {
        border-radius: 5px;
    }

    .card-body:has(.update-rest.show) {
        background: transparent;
    }

    .close {
        font-size: 14px;
        padding: 14px 24px !important;
        background: #0056b3 !important;
        color: #fff;
        border-radius: 15px;
    }

    .hidden {
        display: none;
    }

    .close:hover {
        color: #fff;
    }

    .modal-footer {
        background: #fff;
    }

    .card-footer {
        width: 100%;
        display: flex;
        justify-content: end;
    }

    .navbar {
        z-index: 9999;
    }

    .page-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .page-header h3 {
        font-weight: 500 !important;
        margin-left: 0px !important;
        font-size: 17px !important;
    }
</style>

<div id="loading"></div>

<table class="table table-striped table-listing" id="example" style="width:100%">
    <thead>
        <tr>

        </tr>
        <th>FIRST NAME</th>
        <th>LAST NAME</th>
        <th>EMAIL</th>
        <th>PHONE</th>
        <th>STATUS</th>
        <th>ROLE</th>
        <th onclick="KWACHA_ADMIN.sortBy('au_created', '<%=data.sortOrder %>','<%=data.per_page %>')">CREATED
            AT <i class="fa fa-fw fa-sort"></i></th>
        <th>ACTION</th>
    </thead>
    <tbody id="editor">
        <% if(data.data){ %>
            <% _data=data.data; if(_data.length> 0 ) { %>
                <% for (var i=0; i<_data.length; i++) { %>
                    <% if (data.loginRole==="ADMIN" && (_data[i]['au_role']==="SUPER_ADMIN" )) { continue; } %>
                        <% if (data.loginRole==="MANAGER" && (_data[i]['au_role']==="SUPER_ADMIN"
                            ||_data[i]['au_role']==="ADMIN" )) { continue; } %>
                            <% if (data.loginRole==="MANAGER" && (_data[i]['au_role']==="SUPER_ADMIN"
                                ||_data[i]['au_role']==="ADMIN" ||_data[i]['au_role']==="MANAGER" )) { continue; } %>
                                <tr>
                                    <td class="py-1">
                                        <%= _data[i]['au_firstname'] %>
                                    </td>
                                    <td class="py-1">
                                        <%= _data[i]['au_lastname'] %>
                                    </td>


                                    <td>
                                        <%= _data[i]['au_email'] %>
                                    </td>

                                    <td class="limited-text">

                                        <%=_data[i]['au_mobile'] %>
                                    </td>
                                    <td>
                                        <% if (parseInt(_data[i]['au_active'])===0) { %>
                                            <div
                                                style="width: 15px; height: 15px; border: none; background-color: red;">
                                            </div>
                                            <% } else { %>
                                                <div
                                                    style="width: 15px; height: 15px;  border: none; background-color: rgb(7, 192, 38);">
                                                </div>
                                                <% } %>
                                    </td>



                                    <td>
                                        <%=_data[i]['au_role'] %>
                                    </td>

                                    <td>
                                        <%=_data[i]['au_created'] %>
                                    </td>


                                    <td class="text-right">
                                         <!--<div class="dropdown">
                                            <button class="no-border" type="" id="dropdownMenuButton<%= i %>"
                                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <i class="fas fa-ellipsis-v" style="color:#0056b3;"></i>
                                            </button>
                                            <div class="dropdown-menu dropdown-menu-right"
                                                aria-labelledby="dropdownMenuButton<%= i %>">
                                                <a class="dropdown-item edit jummah_editbtn" href="#editEmployeeModal"
                                                    dataid="<%=_data[i]['au_uuid']%>">
                                                    <i class="fas fa-edit" style="color:#0056b3;"></i> Edit
                                                </a>
                                                <a class="dropdown-item delete" href="#deleteEmployeeModal"
                                                    data-toggle="modal"
                                                    onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                    <i class="fas fa-trash-alt" style="color:#0056b3;"></i> Delete
                                                </a>


                                                <a class="dropdown-item " href="#ActiveEmployeeModal"
                                                    data-toggle="modal"
                                                    onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                    <i class="fas fa-toggle-on" style="color:#0056b3;"></i> Activate
                                                </a>

                                                <a class="dropdown-item " href="#DeactiveEmployeeModal"
                                                    data-toggle="modal"
                                                    onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                    <i class="fas fa-toggle-off" style="color:#0056b3;"></i> Deactivate
                                                </a>
                                                <a class="dropdown-item " href="#sendInboxEmployeeModal"
                                                    data-toggle="modal"
                                                    onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                    <i class="fas fa-envelope" style="color:#0056b3;"></i> Send Inbox
                                                </a>
                                            </div>
                                            </div> -->
                                            <div class="dropdown">
                                                <button class="btn btn-secondary dropdown-toggle bg-transparent" type="button"
                                                    data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="fas fa-ellipsis-v" style="color:#0056b3;"></i>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li>
                                                        <a class="dropdown-item delete" href="#deleteEmployeeModal"
                                                            data-toggle="modal"
                                                            onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                            <i class="fas fa-trash-alt" style="color:#0056b3;"></i>
                                                            Delete
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item " href="#ActiveEmployeeModal"
                                                            data-toggle="modal"
                                                            onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                            <i class="fas fa-toggle-on" style="color:#0056b3;"></i>
                                                            Activate
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item " href="#DeactiveEmployeeModal"
                                                            data-toggle="modal"
                                                            onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                            <i class="fas fa-toggle-off" style="color:#0056b3;"></i>
                                                            Deactivate
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a class="dropdown-item " href="#sendInboxEmployeeModal"
                                                    data-toggle="modal"
                                                    onclick="setUserId(`<%=_data[i]['au_uuid']  %>`)">
                                                    <i class="fas fa-envelope" style="color:#0056b3;"></i> Send Inbox
                                                </a>
                                                    </li>
                                                </ul>
                                            </div>
                                    </td>

                                </tr>
                                <% } %>
                                    <% } else { %>
                                        <tr class="no-record-row">
                                            <td colspan="5" style="text-align: center; vertical-align: middle">
                                                <span>No record found</span>
                                            </td>

                                        </tr>
                                        <% }%>
                                            <% } else { %>
                                                <tr class="no-record-row">
                                                    <td colspan="9" style="text-align: center; vertical-align: middle;">
                                                        <span><b>No
                                                                record
                                                                found</b></span>
                                                    </td>
                                                </tr>

                                                <% } %>
    </tbody>
    <!-- 
    <tr class="no-record-row">
        <td colspan="5" style="text-align: center; vertical-align: middle">
            <span>No record found</span>
        </td>

    </tr> -->

</table>


<!-- End datatable 2024 -->
<% if ( data && data.data && data.data.length> 0 ) { %>
    <div id="paginationLinks">
        <%- include('./include/components/pagination_links',{_function:' KWACHA_ADMIN.init'}); %>
    </div>
    <% } %>
        <!--Start Delete User Modal HTML -->

        </div>
        <!--Start Edit User Modal HTML -->
        <div id="editor">
            <div id="deleteEmployeeModal" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form>
                            <input type="hidden" id="hiddenuser">
                            <div class="modal-header">
                                <h4 class="modal-title">Delete member </h4>
                                <button type="button" class="close hidden" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Are you sure, You want to delete this member?</p>
                            </div>
                            <div class="modal-footer">
                                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">

                                <input id="userdata" type="button" style="background-color: #0056b3; color: #fff;"
                                    type="submit" class="btn btn" value="Delete" onclick="KWACHA_ADMIN.deleteMember()">
                            </div>
                        </form>
                    </div>
                    </form>
                </div>
            </div>


            <div id="ActiveEmployeeModal" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form>
                            <input type="hidden" id="hiddenuser">
                            <div class="modal-header">
                                <h4 class="modal-title">Activate member </h4>
                                <button type="button" class="close hidden" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Are you sure, You want to activate this member?</p>
                            </div>
                            <div class="modal-footer">
                                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">

                                <input id="userdata" type="button" style="background-color: #0056b3; color: #fff;"
                                    type="submit" class="btn btn" value="activate"
                                    onclick="KWACHA_ADMIN.activateMember()">
                            </div>
                        </form>
                    </div>
                    </form>
                </div>
            </div>

            <div id="DeactiveEmployeeModal" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form>
                            <input type="hidden" id="hiddenuser">
                            <div class="modal-header">
                                <h4 class="modal-title">Deactivate member </h4>
                                <button type="button" class="close hidden" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Are you sure, You want to deactivate this member?</p>
                            </div>
                            <div class="modal-footer">
                                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">

                                <input id="userdata" type="button" style="background-color: #0056b3; color: #fff;"
                                    type="submit" class="btn btn" value="deactivate"
                                    onclick="KWACHA_ADMIN.deactivateMember()">
                            </div>
                        </form>
                    </div>
                    </form>
                </div>s
            </div>
            <div id="sendInboxEmployeeModal" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form id="sendInboxForm">
                            <input type="hidden" id="hiddenuser">
                            <div class="modal-header">
                                <h4 class="modal-title">Send Inbox</h4>
                                <button type="button" class="close hidden" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                            </div>
                            <div class="modal-body">
                                <p>Are you sure, You want to send message to this member?</p>
                                <div class="form-group">

                                    <textarea id="inboxMessage" class="form-control" rows="4"
                                        placeholder="Enter your message here"></textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                                <input id="userdata" type="button" style="background-color: #0056b3; color: #fff;"
                                    class="btn btn" value="Send" onclick="KWACHA_ADMIN.sendInbox()">
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div id="editEmployeeModal" class="page-wrapper update-rest modal fade formPart" aria-modal="false"
                role="dialog">
                <div class="">
                    <div class="content container-fluid p-0">
                        <div class="page-header">
                            <h3 class="m-0">Edit Member</h3>
                            <button type="button" class="close show-button" data-dismiss="modal"
                                aria-hidden="true">Member
                                List</button>
                        </div>
                        <form class="forms-sample editEmployeeModlFrom p-0" id="editEmployeeModlFrom" method="post"
                            role="form">
                            <div class="responseformgroup editEmployeeresponseFrom" id="editEmployeeresponseFrom">
                                <div class="loader"></div>
                            </div>
                            <div class="modal-footer" style="border-top: 0px;">
                                <div class="card-footer">
                                    <input type="button" class="btn btn-default cancelbtn" data-dismiss="modal"
                                        value="Cancel">
                                    <button type="submit" class="btn btn-primary mr-2 updateBtn ">
                                        Update
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <style>
            .limited-text {
                max-width: 30ch;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        </style>


        <script>

            $('.show-button').on('click', function (e) {
                e.preventDefault();
                $('.Search').show();
                $('#paginationLinks').show();


            });
            //Start-user Delete
            function setUserId(userId) {
                $("#hiddenuser").val(userId);
            }
            function setSelectedUserId(userId) {
                localStorage.setItem('selectedUserId', userId);
            }

            //   order///////
            function setSelectedOrderId(userId) {
                localStorage.setItem('selectedUserId', userId);
            }
            KWACHA_ADMIN.deleteMember = function () {
                console.log("Function deleteMember executed");
                $("#userdata").html('Processing...');

                let userUuid = $("#hiddenuser").val();
                console.log("Retrieved userUuid:", userUuid);

                if (userUuid) {
                    console.log("Valid userUuid:", userUuid);

                    $.ajax({
                        url: "/admin/delete-member",
                        headers: {
                            Authorization: localStorage.getItem("token"),
                        },
                        data: { memberUuid: userUuid },
                        cache: false,
                        processData: true,
                        contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                        method: "POST",
                        type: "POST",
                        beforeSend: function () {
                            console.log("AJAX request is about to be sent");
                        },
                        success: function (_res) {
                            console.log("AJAX request succeeded", _res);
                            $("#hiddenuser").val("");
                            let successConfig = {
                                title: "Confirmation",
                                message: `Operation performed successfully.`,
                                type: "success",
                            };
                            KWACHA_MAIN.sweetAlert(successConfig);
                        },
                        error: function (e) {
                            console.error("AJAX request failed", e);
                            $("#userdata").html("");
                            let responseText = JSON.parse(e.responseText);
                            let errorConfig = {
                                title: "Error",
                                message: responseText.message,
                                type: "error",
                            };
                            KWACHA_MAIN.sweetAlert(errorConfig);
                        },
                        complete: function () {
                            console.log("AJAX request completed");
                            window.location.reload();
                        }
                    });
                } else {
                    console.log("No userUuid provided, skipping AJAX request");
                    $("#userdata").html("No user selected");
                }
            }


            //***********activate menber********//
            function setSelectedOrderId(userId) {
                localStorage.setItem('selectedUserId', userId);
            }
            KWACHA_ADMIN.activateMember = function () {
                $("#userdata").html('Processing...');
                let userUuid = $("#hiddenuser").val();
                if (userUuid) {
                    $.ajax({
                        url: "/admin/activate-member",
                        data: "userId=" + userUuid,
                        cache: false,
                        processData: false,
                        method: "POST",
                        type: "POST",
                        success: function (_res) {
                            $("#hiddenuser").val("");
                            let successConfig = {
                                title: "Confirmation",
                                message: `Operation performed successfully.`,
                                type: "success",
                            };
                            KWACHA_MAIN.sweetAlert(successConfig);
                        },
                        error: function (e) {
                            $("#userdata").html("");
                            let responseText = JSON.parse(e.responseText);
                            let errorConfig = {
                                title: "Error",
                                message: responseText.message,
                                type: "error",
                            };
                            KWACHA_MAIN.sweetAlert(errorConfig);
                        },
                    });
                }
                window.location.reload();
            }


            //***********deactivate menber********//
            function setSelectedOrderId(userId) {
                localStorage.setItem('selectedUserId', userId);
            }
            KWACHA_ADMIN.deactivateMember = function () {
                $("#userdata").html('Processing...');
                let userUuid = $("#hiddenuser").val();
                if (userUuid) {
                    $.ajax({
                        url: "/admin/deactivate-member",
                        data: "userId=" + userUuid,
                        cache: false,
                        processData: false,
                        method: "POST",
                        type: "POST",
                        success: function (_res) {
                            $("#hiddenuser").val("");
                            let successConfig = {
                                title: "Confirmation",
                                message: `Operation performed successfully.`,
                                type: "success",
                            };
                            KWACHA_MAIN.sweetAlert(successConfig);
                        },
                        error: function (e) {
                            $("#userdata").html("");
                            let responseText = JSON.parse(e.responseText);
                            let errorConfig = {
                                title: "Error",
                                message: responseText.message,
                                type: "error",
                            };
                            KWACHA_MAIN.sweetAlert(errorConfig);
                        },
                    });
                }
                window.location.reload();
            }


            KWACHA_ADMIN.sendInbox = function () {
                $("#userdata").html('Processing...');
                let userUuid = $("#hiddenuser").val();
                let message = $("#inboxMessage").val();

                if (userUuid) {
                    let requestData = {
                        userId: userUuid,
                        message: messagez
                    };

                    $.ajax({
                        url: "/admin/send-inbox",
                        data: JSON.stringify(requestData),
                        contentType: "application/json",
                        cache: false,
                        processData: false,
                        method: "POST",
                        type: "POST",
                        success: function (_res) {
                            $("#hiddenuser").val("");
                            let successConfig = {
                                title: "Confirmation",
                                message: `Operation performed successfully.`,
                                type: "success",
                            };
                            KWACHA_MAIN.sweetAlert(successConfig);
                        },
                        error: function (e) {
                            $("#userdata").html("");
                            let responseText = JSON.parse(e.responseText);
                            let errorConfig = {
                                title: "Error",
                                message: responseText.message,
                                type: "error",
                            };
                            KWACHA_MAIN.sweetAlert(errorConfig);
                        },
                    });
                }
                window.location.reload();
            };


            $('#editEmployeeModlFrom').validate({
                rules: {
                    firstName: {
                        required: true,
                        maxlength: 50 // Example maxlength rule
                    },
                    lastName: {
                        required: true,
                        maxlength: 50
                    },
                    email: {
                        required: true,
                        email: true // Validate email format
                    },
                    phone: {
                        required: true,
                        digits: true // Validate digits only
                    }
                },
                messages: {
                    firstName: {
                        required: "Please enter your first name",
                        maxlength: "First name cannot exceed 50 characters"
                    },
                    lastName: {
                        required: "Please enter your last name",
                        maxlength: "Last name cannot exceed 50 characters"
                    },
                    email: {
                        required: "Please enter your email address",
                        email: "Please enter a valid email address"
                    },
                    phone: {
                        required: "Please enter your phone number",
                        digits: "Please enter only digits"
                    }
                },
                submitHandler: function (form) {
                    let fromdata = $(form).serialize();

                    $.ajax({
                        'url': Homes_url() + 'admin/edit-member',
                        type: 'post',
                        data: fromdata,
                        dataType: 'json',
                        success: function (res) {
                            if (res.status) {
                                const msg = {
                                    title: "Confirmation",
                                    message: 'Operation performed successfully.',
                                    type: "success",
                                };

                                KWACHA_MAIN.sweetAlert(msg);

                            } else {
                                const msg = {
                                    title: "Error",
                                    message: 'Operation performed failed.',
                                    type: "error",
                                };

                                KWACHA_MAIN.sweetAlert(msg);

                            }

                        },
                        error: function (e) {
                            const msg = {
                                title: "Error",
                                message: 'Update failed , "Please fill mandatory fields.",',
                                type: "error"
                            };

                            KWACHA_MAIN.sweetAlert(msg);
                        }
                    });
                }
            });


            $('.jummah_editbtn').on('click', function (e) {
                e.preventDefault();
                const dataid = $(this).attr('dataid');
                let htmls = '';

                $('#example ').hide();
                $('#close ').hide();
                $('.Search').hide();
                $('.selectbox').hide();
                $('#paginationLinks').hide();
                $("#editEmployeeModal").attr('style', 'padding-right: 19px; display: block;');
                $("#editEmployeeModal").attr('aria-modal', 'true');
                $("#editEmployeeModal").attr('role', 'dialog');
                $("#editEmployeeModal").addClass('show');

                function showPaginationLinks() {
                    $('#paginationLinks').show();
                }


                if (dataid != '') {
                    $.ajax({
                        'url': Homes_url() + 'admin/get-member-by-id/' + dataid,
                        type: 'get',
                        headers: {
                            Authorization: localStorage.getItem("token"),
                        },
                        dataType: 'json',
                        success: function (res) {
                            if (res.status) {
                                const obj = res.payload;
                                console.log("obj", obj);
                                htmls += '<div class="card">';
                                htmls += '<div class="card-header">'
                                htmls += '<h1 class="card-title text-white">'
                                htmls += 'Edit Blog Details'
                                htmls += '</h1>'
                                htmls += '</div>'
                                htmls += '<div class="card-body">'

                                htmls += '<div class="row">';

                                htmls += '<input type="hidden" name="memberUuid" id="hiddeneditRestorent" value="' + obj.au_uuid + '">';
                                htmls += '<div class="col-md-12">';
                                htmls += '<div class="form-group">';
                                htmls += '<label for="Name">First Name</label>';
                                htmls += '<input type="text" value="' + obj.au_firstname + '" class="form-control" name="firstName" id="firstName" placeholder=" First Name">';
                                htmls += '</div>';
                                htmls += '</div>';
                                htmls += '<div class="col-md-12">';
                                htmls += '<div class="form-group">';
                                htmls += '<label for="Name"> Last Name</label>';
                                htmls += '<input type="text" value="' + obj.au_lastname + '" class="form-control" name="lastName" id="lastName" placeholder=" Last Name">';
                                htmls += '</div>';
                                htmls += '</div>';
                                htmls += '<div class="col-md-12">';
                                htmls += '<div class="form-group">';
                                htmls += '<label for="Email"> Email Title</label>';
                                htmls += '<input type="text" value="' + obj.au_email + '" class="form-control" name="email" id="email" placeholder="Email">';
                                htmls += '</div>';
                                htmls += '</div>';


                                htmls += '<div  class="col-md-12" style="display: flex; justify-content:space-between" id="form">';
                                htmls += '<div class="sub-options1">';
                                htmls += '<label for="module">Select Module:</label>';
                                htmls += '<div>';
                                htmls += '<select name="module" id="module" multiple>';
                                htmls += '<option value="USER">USER MODULE</option>';
                                htmls += '<option value="NEWS">NEWS MODULE</option>';
                                htmls += '<option value="BLOG">BLOG MODULE</option>';
                                htmls += '<option value="EVENT">EVENT MODULE</option>';
                                htmls += '<option value="MEMBER">MEMBER MODULE</option>';
                                htmls += '</select>';
                                htmls += '</div>';
                                htmls += '</div>';


                                // USER sub options
                                htmls += '<div id="USER-options" class="sub-options">';
                                htmls += '<label for="user-action">User Actions:</label>';
                                htmls += '<br />';
                                htmls += '<select name="user-action" id="user-action" multiple disable>';
                                htmls += '<option value="CREATE">Create User</option>';
                                htmls += '<option value="MANAGE">Manage User</option>';
                                htmls += '</select>';
                                htmls += '</div>';

                                // NEWS sub options
                                htmls += '<div id="NEWS-options" class="sub-options">';
                                htmls += '<label for="news-action">News Actions:</label>';
                                htmls += '<br />';
                                htmls += '<select name="news-action" id="news-action" multiple disable>';
                                htmls += '<option value="CREATE">Create News</option>';
                                htmls += '<option value="MANAGE">Manage News</option>';
                                htmls += '</select>';
                                htmls += '</div>';

                                // BLOG sub options
                                htmls += '<div id="BLOG-options" class="sub-options">';
                                htmls += '<label for="blog-action">Blog Actions:</label>';
                                htmls += '<br />';
                                htmls += '<select name="blog-action" id="blog-action" multiple disable >';
                                htmls += '<option value="CREATE">Create Blog</option>';
                                htmls += '<option value="MANAGE">Manage Blog</option>';
                                htmls += '</select>';
                                htmls += '</div>';

                                // EVENT sub options
                                htmls += '<div id="EVENT-options" class="sub-options">';
                                htmls += '<label for="event-action">Event Actions:</label>';
                                htmls += '<br />';
                                htmls += '<select name="event-action" id="event-action" multiple disable>';
                                htmls += '<option value="CREATE">Create Event</option>';
                                htmls += '<option value="MANAGE">Manage Event</option>';
                                htmls += '</select>';
                                htmls += '</div>';

                                //member sub options
                                htmls += '<div id="MEMBER-options" class="sub-options">';
                                htmls += '<label for="member-action">Member Actions:</label>';
                                htmls += '<br />';
                                htmls += '<select name="member-action" id="member-action" multiple disable>';
                                htmls += '<option value="CREATE">Create Member</option>';
                                htmls += '<option value="MANAGE">Manage Member</option>';
                                htmls += '</select>';
                                htmls += '</div>';

                                htmls += '</div>';

                                htmls += '<div class="col-md-4 role-set">';
                                htmls += '<label style="margin-bottom:10px;" for="Role">Role</label>';
                                htmls += '<div class="form-group">';


                                if (obj.au_role === 'SUPER_ADMIN') {
                                    htmls += '<input type="hidden" id="role" name="role" value="SUPER_ADMIN">';
                                    htmls += '<p>Super Admin</p>';
                                } else {
                                    htmls += '<select style="padding:7px;background:#fff ; border:1px solid grey; border-radius:5px"  id="role" name="role">';
                                    htmls += '<option value="ADMIN"' + (obj.au_role === 'ADMIN' ? ' selected' : '') + '>Admin</option>';
                                    htmls += '<option value="MANAGER"' + (obj.au_role === 'MANAGER' ? ' selected' : '') + '>Manager</option>';
                                    htmls += '<option value="EDITOR"' + (obj.au_role === 'EDITOR' ? ' selected' : '') + '>Editor</option>';
                                    htmls += '</select>';
                                }

                                htmls += '</div>';
                                htmls += '</div>';
                                htmls += '</div>';
                                htmls += '</div>';

                                $('#editEmployeeresponseFrom').html(htmls);

                            } else {
                                $(".modal").removeAttr('style');
                                $(".modal").attr('aria-modal', 'false');
                                $(".modal").removeAttr('role');
                                $(".modal").removeClass('show');
                                const msg = {
                                    title: "Error",
                                    message: 'Edit failed...',
                                    type: "error"
                                };

                                KWACHA_MAIN.sweetAlert(msg);

                            }

                        }
                    });

                } else {

                    $(".modal").removeAttr('style');
                    $(".modal").attr('aria-modal', 'false');
                    $(".modal").removeAttr('role');
                    $(".modal").removeClass('show');

                    const msg = {
                        title: "Error",
                        message: 'Edit failed...',
                        type: "error"
                    };

                    KWACHA_MAIN.sweetAlert(msg);

                }
            });

            $('.close').on('click', function (e) {
                e.preventDefault();
                $('#example ').show();
                $('#close ').show();
                $(".modal").removeAttr('style');
                $(".modal").attr('aria-modal', 'false');
                $(".modal").removeAttr('role');
                $('.modal').removeClass('show');
            });


            $('.cancelbtn').on('click', function (e) {
                e.preventDefault();
                $('.modal').removeClass('show');
                $(".modal").removeAttr('style');
                $(".modal").attr('aria-modal', 'false');
                $(".modal").removeAttr('role');
            });


            $(document).ready(function () {
                $('.jummah_editbtn').click(function () {
                    $('.datatable').hide();
                    $('.selectbox').hide();
                });
                $('.close').click(function () {
                    $('.update-rest').hide();
                    $('.datatable').show();
                    $('.selectbox').show();
                });
                $('.confirm').click(function () {
                    $('.update-rest').hide();
                    $('.datatable').show();
                    $('.selectbox').show();
                });
                $('.cancelbtn').click(function () {
                    $('.update-rest').hide();
                    $('.datatable').show();
                    $('.selectbox').show();
                });
            });
            function updateSubOptions() {
                const roleSelect = document.getElementById('module');
                const selectedRoles = Array.from(roleSelect.selectedOptions).map(option => option.value);
                const subOptions = document.querySelectorAll('.sub-options select');


                subOptions.forEach(option => option.disabled = true);


                selectedRoles.forEach(role => {
                    const selectedSubOptions = document.getElementById(`${role}-options`);
                    if (selectedSubOptions) {
                        selectedSubOptions.querySelector('select').disabled = false;
                    }
                });
            }


            function prepareFormData(event) {
                const roleSelect = document.getElementById('module');
                const selectedRoles = Array.from(roleSelect.selectedOptions).map(option => option.value);

                const formData = {
                    mainRoles: selectedRoles,
                    subRoles: {}
                };

                selectedRoles.forEach(role => {
                    const subSelect = document.querySelector(`#${module}-options select`);
                    const selectedSubOptions = subSelect ? Array.from(subSelect.selectedOptions).map(option => option.value) : [];
                    formData.subRoles[role] = selectedSubOptions;
                });
                event.preventDefault();
                console.log("Form Data: ", formData);

            }


            window.onload = function () {
                document.getElementById('module').addEventListener('change', updateSubOptions);
                document.getElementById('form').addEventListener('submit', prepareFormData);
                updateSubOptions();
            }
            let userRole = localStorage.getItem("role");
            if (userRole === "SUPER_ADMIN" || "ADMIN" || "MANAGER") {
                document.querySelector(".no-record-row").style.display = "none"
            }
            if (userRole === "EDITOR") {
                document.getElementById("editor").style.display = "none"
                document.getElementById("paginationLinks").style.display = "none"
                document.querySelector(".no-record-row").style.display = "block"

            }

        </script>